(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{Muja:function(t,e,n){"use strict";var s=n("EqEh");e.a=function(t,e){return Object(s.a)(t,e)}},wbm3:function(t,e,n){"use strict";n.r(e),n.d(e,"EvaluateAbsencesModule",function(){return tt});var s=n("PCNd"),i=n("tyNb"),r=n("1G5W"),c=n("CCnw"),o=n("CqUA"),a=n("NPit"),l=n("fhBx"),u=n("Xr/R"),b=n("fXoL"),d=n("ofXK");let f=(()=>{class t extends l.b{constructor(t,e,n,s){super(t,e,n,"/evaluate-absences"),this.lessonPresenceService=s,this.queryParamsString$.pipe(Object(r.a)(this.destroy$)).subscribe(t=>this.confirmBackLinkParams={returnparams:t})}getInitialFilter(){return{student:null,educationalEvent:null,studyClass:null}}isValidFilter(t){return Boolean(t.student||t.educationalEvent||t.studyClass)}getInitialSorting(){return{key:"StudentFullName",ascending:!0}}loadEntries(t,e,n){return this.loadingService.load(this.lessonPresenceService.getStatistics(t,e,n),l.a)}buildParamsFromFilter(t){return Object(a.a)(t)}}return t.\u0275fac=function(e){return new(e||t)(b.Zb(d.i),b.Zb(o.a),b.Zb(u.a),b.Zb(c.a))},t.\u0275prov=b.Ib({token:t,factory:t.\u0275fac}),t})();var h=n("qUtt"),g=n("0HM3");let p=(()=>{class t{constructor(t){this.state=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(b.Mb(f))},t.\u0275cmp=b.Gb({type:t,selectors:[["erz-evaluate-absences"]],features:[b.yb([f,{provide:h.a,useExisting:f},{provide:g.a,useValue:"/evaluate-absences"}])],decls:1,vars:0,template:function(t,e){1&t&&b.Nb(0,"router-outlet")},directives:[i.k],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),t})();var m=n("lJxs"),v=n("IzEk"),y=n("yl8S"),S=n("KJh6"),P=n("EOpz"),C=n("mmcK"),R=n("vjgy"),O=n("4vbw"),z=n("jSy9"),k=n("sYmb");let $=(()=>{class t{constructor(t,e,n){this.studentsService=t,this.educationalEventsService=e,this.studyClassesService=n,this.filter={student:null,educationalEvent:null,studyClass:null},this.filterChange=new b.n}ngOnInit(){}show(){this.filterChange.emit(this.filter)}}return t.\u0275fac=function(e){return new(e||t)(b.Mb(C.a),b.Mb(R.a),b.Mb(O.a))},t.\u0275cmp=b.Gb({type:t,selectors:[["erz-evaluate-absences-header"]],inputs:{filter:"filter"},outputs:{filterChange:"filterChange"},decls:20,vars:18,consts:[[1,"filters","mb-2"],[1,"form-group"],[3,"typeaheadService","value","valueChange"],[1,"buttons"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(b.Sb(0,"div",0),b.Sb(1,"div",1),b.Sb(2,"label"),b.Dc(3),b.gc(4,"translate"),b.Rb(),b.Sb(5,"erz-typeahead",2),b.dc("valueChange",function(t){return e.filter.student=t}),b.Rb(),b.Rb(),b.Sb(6,"div",1),b.Sb(7,"label"),b.Dc(8),b.gc(9,"translate"),b.Rb(),b.Sb(10,"erz-typeahead",2),b.dc("valueChange",function(t){return e.filter.educationalEvent=t}),b.Rb(),b.Rb(),b.Sb(11,"div",1),b.Sb(12,"label"),b.Dc(13),b.gc(14,"translate"),b.Rb(),b.Sb(15,"erz-typeahead",2),b.dc("valueChange",function(t){return e.filter.studyClass=t}),b.Rb(),b.Rb(),b.Sb(16,"div",3),b.Sb(17,"button",4),b.dc("click",function(){return e.show()}),b.Dc(18),b.gc(19,"translate"),b.Rb(),b.Rb(),b.Rb()),2&t&&(b.zb(3),b.Ec(b.hc(4,10,"evaluate-absences.header.student")),b.zb(2),b.lc("typeaheadService",e.studentsService)("value",e.filter.student),b.zb(3),b.Ec(b.hc(9,12,"evaluate-absences.header.module-instance")),b.zb(2),b.lc("typeaheadService",e.educationalEventsService)("value",e.filter.educationalEvent),b.zb(3),b.Ec(b.hc(14,14,"evaluate-absences.header.study-class")),b.zb(2),b.lc("typeaheadService",e.studyClassesService)("value",e.filter.studyClass),b.zb(3),b.Fc(" ",b.hc(19,16,"evaluate-absences.header.show")," "))},directives:[z.a],pipes:[k.c],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:1.5rem;border-bottom:1px solid #dee2e6}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{flex:1;min-width:20rem;max-width:40rem;margin-right:1.5rem;margin-bottom:.75rem}.buttons[_ngcontent-%COMP%]{flex:none;margin-top:2.75rem;margin-right:0}@media (max-width:767.98px){.buttons[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;margin-bottom:1.5rem}}"],changeDetection:0}),t})();var w=n("dlKe"),E=n("4Kj8");function F(t,e){if(1&t){const t=b.Tb();b.Sb(0,"th",13),b.dc("click",function(){b.vc(t);const n=e.$implicit;return b.fc(5).state.toggleSorting(n.key)}),b.Sb(1,"div",14),b.Sb(2,"div",15),b.Dc(3),b.gc(4,"translate"),b.Rb(),b.Sb(5,"div",16),b.Dc(6),b.gc(7,"async"),b.Rb(),b.Rb(),b.Rb()}if(2&t){const t=e.$implicit,n=b.fc(5);b.lc("ngClass",t.label),b.zb(3),b.Fc(" ",b.hc(4,3,"evaluate-absences.list.header."+t.label)," "),b.zb(3),b.Fc(" ",b.hc(7,5,n.getSortingChar$(t))," ")}}const j=function(t){return["student",t]},I=function(t){return{returnparams:t}};function x(t,e){if(1&t&&(b.Sb(0,"a",20),b.gc(1,"async"),b.Dc(2),b.Rb()),2&t){const t=b.fc().$implicit,e=b.fc().$implicit,n=b.fc(6);b.lc("routerLink",b.pc(5,j,e.StudentRef.Id))("queryParams",b.pc(7,I,b.hc(1,3,n.profileReturnParams$))),b.zb(2),b.Fc(" ",e[t.key]," ")}}function M(t,e){if(1&t&&b.Dc(0),2&t){const t=b.fc().$implicit,e=b.fc().$implicit;b.Fc(" ",e[t.key]," ")}}function B(t,e){if(1&t&&(b.Sb(0,"td"),b.gc(1,"translate"),b.Bc(2,x,3,9,"a",18),b.Bc(3,M,1,1,"ng-template",null,19,b.Cc),b.Rb()),2&t){const t=e.$implicit,n=b.uc(4);b.Ab("data-label",b.hc(1,3,"evaluate-absences.list.header."+t.label)),b.zb(2),b.lc("ngIf","StudentFullName"===t.key)("ngIfElse",n)}}function D(t,e){if(1&t&&(b.Sb(0,"tr"),b.Bc(1,B,5,5,"td",17),b.Rb()),2&t){const t=b.fc(6);b.zb(1),b.lc("ngForOf",t.columns)}}function T(t,e){if(1&t&&(b.Sb(0,"tbody"),b.Bc(1,D,2,1,"tr",17),b.Rb()),2&t){const t=b.fc(4).erzLet;b.zb(1),b.lc("ngForOf",t.entries)}}function L(t,e){1&t&&b.Nb(0,"erz-spinner",21)}function N(t,e){if(1&t){const t=b.Tb();b.Sb(0,"button",22),b.dc("click",function(){return b.vc(t),b.fc(5).state.nextPage()}),b.Dc(1),b.gc(2,"translate"),b.Rb()}2&t&&(b.zb(1),b.Fc(" ",b.hc(2,1,"global.pagination.load-more")," "))}function A(t,e){if(1&t){const t=b.Tb();b.Sb(0,"div",7),b.Sb(1,"table",8),b.dc("scrolled",function(){return b.vc(t),b.fc(4).onScroll()}),b.Sb(2,"thead"),b.Sb(3,"tr"),b.Bc(4,F,8,7,"th",9),b.Rb(),b.Rb(),b.Bc(5,T,2,1,"tbody",10),b.Rb(),b.Bc(6,L,1,0,"erz-spinner",11),b.Bc(7,N,3,3,"button",12),b.Rb()}if(2&t){const t=b.fc(3).erzLet,e=b.fc();b.zb(4),b.lc("ngForOf",e.columns),b.zb(1),b.lc("ngIf",t.entries&&t.entries.length>0),b.zb(1),b.lc("ngIf",t.loadingPage),b.zb(1),b.lc("ngIf",t.hasMore&&!t.loadingPage)}}function q(t,e){1&t&&(b.Sb(0,"p",23),b.Dc(1),b.gc(2,"translate"),b.Rb()),2&t&&(b.zb(1),b.Fc(" ",b.hc(2,1,"evaluate-absences.no-entries")," "))}function _(t,e){if(1&t&&(b.Qb(0),b.Bc(1,A,8,4,"div",5),b.Bc(2,q,3,3,"ng-template",null,6,b.Cc),b.Pb()),2&t){const t=b.uc(3),e=b.fc(2).erzLet;b.zb(1),b.lc("ngIf",e.entries&&e.entries.length>0||e.loadingPage)("ngIfElse",t)}}function K(t,e){1&t&&b.Nb(0,"erz-spinner")}function Z(t,e){if(1&t&&(b.Qb(0),b.Bc(1,_,4,2,"ng-container",2),b.gc(2,"async"),b.Bc(3,K,1,0,"ng-template",null,4,b.Cc),b.Pb()),2&t){const t=b.uc(4),e=b.fc(2);b.zb(1),b.lc("ngIf",!b.hc(2,2,e.state.loading$))("ngIfElse",t)}}function G(t,e){1&t&&(b.Sb(0,"p",23),b.Dc(1),b.gc(2,"translate"),b.Rb()),2&t&&(b.zb(1),b.Ec(b.hc(2,1,"evaluate-absences.no-filter")))}function J(t,e){if(1&t){const t=b.Tb();b.Qb(0),b.Sb(1,"erz-evaluate-absences-header",1),b.dc("filterChange",function(e){return b.vc(t),b.fc().state.setFilter(e)}),b.gc(2,"async"),b.Rb(),b.Bc(3,Z,5,4,"ng-container",2),b.gc(4,"async"),b.Bc(5,G,3,3,"ng-template",null,3,b.Cc),b.Pb()}if(2&t){const t=b.uc(6),e=b.fc();b.zb(1),b.lc("filter",b.hc(2,3,e.filterFromParams$)),b.zb(2),b.lc("ngIf",b.hc(4,5,e.state.isFilterValid$))("ngIfElse",t)}}const X=function(t,e,n){return{entries:t,hasMore:e,loadingPage:n}};let V=(()=>{class t{constructor(t,e,n,s){this.state=t,this.scrollPosition=e,this.route=n,this.presenceTypesService=s,this.columns=[{key:"StudentFullName",label:"student"},{key:"TotalAbsences",label:"total"},{key:"TotalAbsencesValidExcuse",label:"valid-excuse"},{key:"TotalAbsencesWithoutExcuse",label:"without-excuse"},{key:"TotalAbsencesUnconfirmed",label:"unconfirmed"},{key:"TotalIncidents",label:"incident"}],this.filterFromParams$=this.route.queryParams.pipe(Object(m.a)(U)),this.profileReturnParams$=this.state.queryParamsString$}ngOnInit(){this.filterFromParams$.pipe(Object(v.a)(1)).subscribe(t=>this.state.setFilter(t)),this.presenceTypesService.halfDayActive$.subscribe(t=>{t&&(this.columns=[...this.columns,{key:"TotalHalfDays",label:"halfday"}])})}ngAfterViewInit(){this.scrollPosition.restore()}onScroll(){this.state.nextPage()}getSortingChar$(t){return this.state.sorting$.pipe(Object(m.a)(e=>e&&t.key===e.key?e.ascending?"\u2193":"\u2191":""))}}return t.\u0275fac=function(e){return new(e||t)(b.Mb(f),b.Mb(y.a),b.Mb(i.a),b.Mb(S.a))},t.\u0275cmp=b.Gb({type:t,selectors:[["erz-evaluate-absences-list"]],decls:4,vars:11,consts:[[4,"erzLet"],[3,"filter","filterChange"],[4,"ngIf","ngIfElse"],["noFilter",""],["loading",""],["class","p-3",4,"ngIf","ngIfElse"],["noEntries",""],[1,"p-3"],["infiniteScroll","",1,"table","table-striped","table-fixed",3,"scrolled"],["scope","col",3,"ngClass","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","inline",4,"ngIf"],["type","button","class","btn btn-secondary btn-sm d-block mx-auto",3,"click",4,"ngIf"],["scope","col",3,"ngClass","click"],[1,"d-flex"],[1,"column-title"],[1,"sort-direction"],[4,"ngFor","ngForOf"],["class","student",3,"routerLink","queryParams",4,"ngIf","ngIfElse"],["noLink",""],[1,"student",3,"routerLink","queryParams"],[1,"inline"],["type","button",1,"btn","btn-secondary","btn-sm","d-block","mx-auto",3,"click"],[1,"mt-3","px-3"]],template:function(t,e){1&t&&(b.Bc(0,J,7,7,"ng-container",0),b.gc(1,"async"),b.gc(2,"async"),b.gc(3,"async")),2&t&&b.lc("erzLet",b.rc(7,X,b.hc(1,1,e.state.entries$),b.hc(2,3,e.state.hasMore$),b.hc(3,5,e.state.loadingPage$)))},directives:[P.a,$,d.m,w.a,d.l,d.k,i.i,E.a],pipes:[d.b,k.c],styles:["th[_ngcontent-%COMP%]{cursor:pointer}th.student[_ngcontent-%COMP%]{width:30%}.column-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}a.student[_ngcontent-%COMP%]{color:#33333d}"],changeDetection:0}),t})();function U(t){return{student:t.student?Number(t.student):null,educationalEvent:t.educationalEvent?Number(t.educationalEvent):null,studyClass:t.studyClass?Number(t.studyClass):null}}var H=n("ccj6"),Q=n("hH5/");const W=[{path:"",component:p,children:[{path:"",component:V,data:{restoreScrollPositionFrom:["/evaluate-absences/student/:id"]}},{path:"student/:id",children:[{path:"",component:H.a},{path:"confirm",component:Q.a}]}]}];let Y=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Kb({type:t}),t.\u0275inj=b.Jb({imports:[[i.j.forChild(W)],i.j]}),t})(),tt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Kb({type:t}),t.\u0275inj=b.Jb({imports:[[s.a,Y]]}),t})()},yl8S:function(t,e,n){"use strict";n.d(e,"a",function(){return m});var s=n("tyNb"),i=n("XNiG"),r=n("LRne"),c=n("pLZG"),o=n("lJxs"),a=n("IzEk"),l=n("5+tZ"),u=n("eIep"),b=n("Y6wi"),d=n("UXun"),f=n("1G5W"),h=n("zP0r"),g=n("fXoL"),p=n("ofXK");let m=(()=>{class t{constructor(t,e){this.router=t,this.viewportScroller=e,this.scrollPositions={},this.previousRoute=null,this.currentRoute=null,this.currentScrollPosition=[0,0],this.destroy$=new i.a,this.scrollPosition$=this.router.events.pipe(Object(c.a)(y),Object(o.a)(this.getScrollPosition.bind(this))),this.activationEnd$=this.router.events.pipe(Object(c.a)(v)),this.navigationEnd$=this.router.events.pipe(Object(c.a)(S)),this.route$=this.activationEnd$.pipe(Object(a.a)(1)).pipe(Object(l.a)(t=>[Object(r.a)(t),this.navigationEnd$.pipe(Object(u.a)(()=>this.activationEnd$.pipe(Object(a.a)(1))))]),Object(b.a)(),Object(o.a)(t=>t.snapshot),Object(d.a)(1)),this.scrollPosition$.pipe(Object(f.a)(this.destroy$)).subscribe(t=>this.currentScrollPosition=t),this.route$.pipe(Object(f.a)(this.destroy$)).subscribe(t=>{this.previousRoute=this.currentRoute,this.currentRoute=t})}ngOnDestroy(){this.destroy$.next()}restore(){if(!this.currentRoute||!this.requiresStoring(this.currentRoute))return;if(this.previousRoute&&this.shouldStoreFor(this.currentRoute,this.previousRoute)){const t=this.getPath(this.currentRoute);this.scrollToPosition(this.scrollPositions[t]||[0,0])}const t=this.currentRoute;this.route$.pipe(Object(h.a)(1),Object(a.a)(1),Object(f.a)(this.destroy$),Object(c.a)(e=>this.shouldStoreFor(t,e))).subscribe(()=>{const e=this.getPath(t);this.scrollPositions[e]=this.currentScrollPosition})}getScrollPosition(){return this.viewportScroller.getScrollPosition()}scrollToPosition(t){this.viewportScroller.scrollToPosition(t)}getPath(t){return t?"/"+t.pathFromRoot.map(t=>t.routeConfig&&t.routeConfig.path).filter(t=>t).join("/"):"/"}requiresStoring(t){return Boolean(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)&&t.routeConfig.data.restoreScrollPositionFrom.length>0)}shouldStoreFor(t,e){return(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)?t.routeConfig.data.restoreScrollPositionFrom:[]).includes(this.getPath(e))}}return t.\u0275fac=function(e){return new(e||t)(g.Zb(s.g),g.Zb(p.t))},t.\u0275prov=g.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function v(t){return t instanceof s.b}function y(t){return t instanceof s.e}function S(t){return t instanceof s.d}}}]);